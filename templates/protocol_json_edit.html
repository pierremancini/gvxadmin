{% extends 'admin/model/edit.html' %}

{% block body %}

    {{ super() }}


<!--     <script src="{{ url_for('static', filename='graphic/js/jsoneditor.js') }}"></script> -->


    <link rel="stylesheet" href="{{ url_for('static', filename='code/css/jsoneditor.css') }}">

    <style type="text/css">

      div.jsoneditor {
        // Override css du jsoneditor pour avoir une fenetre scrollable.
        color: #1A1A1A;
        border: 1px solid #3883fa;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        width: 100%;
        height: 500px;
        position: relative;
        padding: 0;
        line-height: 100%;
      }

    </style>

    <script src="{{ url_for('static', filename='code/js/jsoneditor.js') }}"></script>

    <script>

      var schema = {
        "title": "Example Schema",
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "gender": {
            "enum": ["male", "female"]
          },
          "age": {
            "description": "Age in years",
            "type": "integer",
            "minimum": 0
          },
          "job": {
            "$ref": "job"
          }
        },
        "required": ["firstName", "lastName", "gender"]
      };

      var job = {
        "title": "Job description",
        "type": "object",
        "properties": {
          "company": {
            "type": "string"
          },
          "role": {
            "type": "string"
          }
        }
      };

      function updateConfigField() {
        document.getElementById('config_json').value = editor.getText();

      }

      var options = {
        schema: schema,
        schemaRefs: {"job": job},
        onChange: updateConfigField
      };

      var container = document.getElementById('config_json').parentNode;

      var json = JSON.parse(document.getElementById('config_json').value);

      var editor = new JSONEditor(container, options, json);


      document.getElementById('config_json').addEventListener('keyup', updateEditor);

      function updateEditor() {

        console.log('appel')
        editor.set(JSON.parse(document.getElementById('config_json').value));

      }




    </script>

{% endblock %}
